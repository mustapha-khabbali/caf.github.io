<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Prediction Arena</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            /* Background pattern (a.png) */
            background-image: url('a.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;f
            margin: 0;
            font-family: sans-serif;
        }

        /* Styling for the score capsule */
        .score-capsule {
            background: linear-gradient(to right, #911a1d, #b91c1c);
            border-bottom-right-radius: 50px;
            border-top-left-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            border-bottom: 2px solid #ef4444;
        }

    .mascot-container {
    position: fixed;
    bottom: 5px;
    right: 10px;
    width: 220px; /* Adjust size here */
    
    /* This makes it stay in front of EVERYTHING */
    z-index: 9999; 
    
    /* This ensures you can still click buttons or inputs 
       even if the mascot is physically 'on top' of them */
    pointer-events: none; 
}

.mascot-container img {
    width: 100%;
    height: auto;
    display: block;
    /* Optional: drop shadow to make him stand out from the cards */
    filter: drop-shadow(0 10px 15px rgba(0,0,0,0.5));
}

        @keyframes pop {
            to { transform: scale(1); }
        }
    </style>
</head>
<body>

    <header class="w-full flex justify-center items-center py-4 bg-transparent">
        <img src="b.png" alt="Header Logos" 
             style="width: 40%;" 
             class="h-auto block">
    </header>

    <main class="max-w-6xl mx-auto p-6 relative mt-[-60px]">
    
    <div class="flex justify-center mb-10">
        <div class="score-capsule flex items-center justify-between px-12 py-0 w-full max-w-[850px]" 
             style="background-color: #b11f24; border-top-right-radius: 65px; border-bottom-right-radius: 0; border-top-left-radius: 4px; border-bottom-left-radius: 4px; box-shadow: 0 10px 25px rgba(0,0,0,0.4);">
            
            <div class="flex items-center gap-5">
                <span style="font-family: 'League Spartan', sans-serif; font-weight: 900; color: white; text-transform: uppercase; font-size: 1.875rem; letter-spacing: -0.05em;">Morocco</span>
            <div style="background-color: white; 
        padding: 2px; 
        display: flex; 
        align-items: center; 
        justify-content: center; 
        width: 85px; 
        height: 50px; 
        clip-path: polygon(15% 0%, 85% 0%, 100% 50%, 85% 100%, 15% 100%, 0% 50%);">
         <img src="https://flagcdn.com/w160/ma.png" 
             style="
                width: 100%; 
                height: 100%; 
                object-fit: cover; 
                clip-path: polygon(15% 0%, 85% 0%, 100% 50%, 85% 100%, 15% 100%, 0% 50%);
             " 
             alt="Maroc">
        </div> 
                     
            </div>
            
            <div class="flex items-center gap-4" style="font-family: 'League Spartan', sans-serif; font-weight: 900; color: white; font-size: 3.75rem;">
                <span>3</span>
                <span style="opacity: 0.6; font-size: 2rem; margin-top: 4px;">-</span>
                <span>0</span>
            </div>

         <div class="flex items-center gap-5">
    <div style="
        background-color: white; 
        padding: 2px; 
        display: flex; 
        align-items: center; 
        justify-content: center; 
        width: 85px; 
        height: 50px; 
        clip-path: polygon(15% 0%, 85% 0%, 100% 50%, 85% 100%, 15% 100%, 0% 50%);
    ">
        <img src="https://flagcdn.com/w160/ml.png" 
             style="
                width: 100%; 
                height: 100%; 
                object-fit: cover; 
                clip-path: polygon(15% 0%, 85% 0%, 100% 50%, 85% 100%, 15% 100%, 0% 50%);
             " 
             alt="Mali">
    </div>
    <span style="font-family: 'League Spartan', sans-serif; font-weight: 900; color: white; text-transform: uppercase; font-size: 1.875rem; letter-spacing: -0.05em;">
        Mali
    </span>
</div>

        </div>
    </div>

        <div class="grid md:grid-cols-2 gap-8 relative z-20">
            
            <section class="bg-red-900/30 p-8 rounded-2xl border border-white/10 backdrop-blur-md">
                <h2 class="text-2xl font-bold mb-6 text-yellow-500">Enter Your Pronostic</h2>
                <div class="space-y-4">
                    <input type="text" id="userName" placeholder="Your Name" 
                           class="w-full p-3 rounded bg-black/50 border border-green-900 focus:border-green-500 focus:outline-none transition-colors">
                    
                    <div class="flex gap-4">
                        <div class="flex-1">
                            <label class="block text-xs mb-1 text-gray-400">MAR Score</label>
                            <input type="number" id="scoreA" class="w-full p-3 rounded bg-black/50 border border-green-900" value="0">
                        </div>
                        <div class="flex-1">
                            <label class="block text-xs mb-1 text-gray-400">MAL Score</label>
                            <input type="number" id="scoreB" class="w-full p-3 rounded bg-black/50 border border-green-900" value="0">
                        </div>
                    </div>

                    <button onclick="addPrediction()" class="w-full py-4 bg-[#d48c00] hover:bg-yellow-500 text-black font-black rounded-lg transition-all uppercase mt-4 shadow-lg">
                        Submit Prediction
                    </button>
                </div>
            </section>

            <section class="bg-black/40 p-6 rounded-2xl border border-white/10 backdrop-blur-sm">
                <h2 class="text-xl font-bold mb-4 text-yellow-500">Who is Near to Win?</h2>
                <canvas id="accuracyChart" height="200"></canvas>
            </section>
        </div>

        <section class="mt-12 mb-20">
            <h2 class="text-2xl font-bold mb-6 text-center text-white/90">Current Leaderboard</h2>
            <div id="leaderboard" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                </div>
        </section>

    </main>

    <div class="mascot-container">
    <img src="c.png" alt="Mascot">
</div>

    <script>
    const predictions = [];
    const liveScore = { a: 0, b: 0 }; 

    // --- LIVE SCORE CONFIGURATION ---
    const API_KEY = 'YOUR_API_KEY_HERE'; // Replace with your actual key
    const FIXTURE_ID = '123456'; // Replace with the actual Morocco vs Mali Match ID
    // --------------------------------

    async function fetchLiveScore() {
        try {
            const response = await fetch(`https://v3.football.api-sports.io/fixtures?id=${FIXTURE_ID}`, {
                "method": "GET",
                "headers": {
                    "x-rapidapi-host": "v3.football.api-sports.io",
                    "x-rapidapi-key": API_KEY
                }
            });

            const data = await response.json();
            const match = data.response[0];

            if (match) {
                // Update internal score
                liveScore.a = match.goals.home ?? 0;
                liveScore.b = match.goals.away ?? 0;

                // Update the UI (The Score Capsule)
                const scoreElements = document.querySelectorAll('.score-capsule span');
                scoreElements[1].innerText = liveScore.a; // Morocco Score
                scoreElements[3].innerText = liveScore.b; // Mali Score

                console.log(`Updated Live Score: ${liveScore.a} - ${liveScore.b}`);
                
                // Refresh accuracies for existing predictions
                updateLeaderboardUI();
            }
        } catch (error) {
            console.error("Error fetching live score:", error);
        }
    }

    // Run fetch every 60 seconds
    setInterval(fetchLiveScore, 60000);
    // Run once immediately on load
    fetchLiveScore();

    // --- REST OF YOUR FUNCTIONS ---

    const ctx = document.getElementById('accuracyChart').getContext('2d');
    const accuracyChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['Start', '15\'', '30\'', '45\'', 'Now'],
            datasets: []
        },
        options: {
            responsive: true,
            scales: { 
                y: { beginAtZero: true, max: 100, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#888' } },
                x: { grid: { display: false }, ticks: { color: '#888' } }
            },
            plugins: { legend: { labels: { color: 'white', font: { size: 10 } } } }
        }
    });

    function calculateAccuracy(predA, predB) {
        const diff = Math.abs(predA - liveScore.a) + Math.abs(predB - liveScore.b);
        return Math.max(0, 100 - (diff * 20));
    }

    function addPrediction() {
        const name = document.getElementById('userName').value;
        const sA = parseInt(document.getElementById('scoreA').value);
        const sB = parseInt(document.getElementById('scoreB').value);

        if (!name) return alert("Please enter your name!");

        const acc = calculateAccuracy(sA, sB);
        predictions.push({ name, sA, sB, accuracy: acc });
        
        updateLeaderboardUI();
        updateChart(name, acc);
    }

    function updateLeaderboardUI() {
        const container = document.getElementById('leaderboard');
        container.innerHTML = ''; // Clear current

        predictions.forEach(p => {
            // Recalculate accuracy based on latest liveScore
            p.accuracy = calculateAccuracy(p.sA, p.sB);

            const card = document.createElement('div');
            card.className = "bg-green-900/80 p-4 rounded-xl border-t-4 border-yellow-500 text-center shadow-xl backdrop-blur-sm";
            card.innerHTML = `
                <div class="text-xs font-bold text-yellow-500 uppercase">${p.name}</div>
                <div class="text-2xl font-black">${p.sA} - ${p.sB}</div>
                <div class="text-[10px] text-gray-300 mt-1">${p.accuracy}% Match</div>
            `;
            container.appendChild(card);
        });
    }

    function updateChart(name, acc) {
        const color = `hsl(${Math.random() * 360}, 70%, 60%)`;
        accuracyChart.data.datasets.push({
            label: name,
            data: [40, 55, 45, 60, acc],
            borderColor: color,
            backgroundColor: color,
            tension: 0.4,
            borderWidth: 2,
            pointRadius: 2
        });
        accuracyChart.update();
    }
</script>
</body>
</html>
